import requests
import hashlib
import re

req = requests.session()
url = "http://docker.hackthebox.eu:31847"

## Get Request

rget = req.get(url)
html = rget.content

## Strip HTML

def html_tags(html):
	clean = re.compile('<.*?>')
	return re.sub(clean, '', html)

#print(html_tags(html))


## Splilting Random String
out1 = html_tags(html)
out2 = out1.split('string')[1]
out3 = out2.rstrip()
#print(out3)

## MD5 Encrypt

md5Hash = hashlib.md5(out3).hexdigest()
#print(md5Hash)

## POST Request

data = dict(hash=md5Hash)
rpost = req.post(url=url ,data=data)
html = rpost.text
#print(rpost.text)

out = html_tags(html)

flag = out.split('string')[1]
flag = flag.rstrip()
flag = flag.split('{')[1]
print('{' + flag)
